
<% layout("/layouts/boilerplate") %>
<!--  -->
<style>
  /* #filters {
    display: flex;
    flex-wrap: wrap;
  }
  .filter {
    text-align: center;
    margin-right: 2rem;
    margin-top: 2rem;
    opacity: 0.7;
  }
  .filter:hover {
    opacity: 1;
    cursor: pointer;
  }
  .filter p {
    font-size: 0.8rem;
  } */


 /* Default (large screens): horizontal row */
#filters {
  display: flex;
  flex-direction: row; /* default for larger screens */
  align-items: center;
  gap: 1rem;
  flex-wrap: nowrap;
  /* overflow: hidden; */
  /* padding: 50px; */
  padding-top: 30px;
  width: 100%;
  box-sizing: border-box; /* Prevent overflow on small screens */
}
.filter p{
  font-size: 0.8rem;
}

.filters-container {
  /* display: flex;
  flex-wrap: nowrap;
  overflow-x: auto;
  gap: 1rem; */
  display: flex;
  flex-wrap:nowrap;         /* ðŸ‘ˆ allow wrapping on large screens */
  gap: 1rem;
  overflow-x: visible; 
}

.filter {
  display: flex;
  flex-direction: column;
  align-items: center;
  min-width: 80px;
  white-space: nowrap;
  cursor: pointer;
  opacity: 0.7;
}
.filter:hover {
    opacity: 1;
    cursor: pointer;
  }

.tax-toggle {
  /* margin-left: auto; */
  white-space: nowrap;
  border: 1px solid black;
  border-radius: 1rem;
  height: 3.5rem;
  padding: 1rem;
  margin-bottom: 25px;

}

.more-button {
  display: none;
  font-size: 24px;
  cursor: pointer;

}

 /* @media (max-width: 768px) and (min-width: 481px) {
  .filters-container {
    display: flex;
    flex-wrap: nowrap;
    overflow: auto;

  }
 
  .more-button {
    display: none;
  }
} */
 @media (min-width: 481px) and (max-width: 1425px) {
  #filters {
    display: flex;
    align-items: center;
    justify-content: space-between;
    overflow: hidden;
    gap: 10px;
    padding: 10px;
  }

  .filters-container {
    display: flex;
    flex-wrap: nowrap;
    overflow-x: auto;
    -webkit-overflow-scrolling: touch;
    white-space: nowrap;
    gap: 10px;
    flex-grow: 1;
  }

  .filters-container::-webkit-scrollbar {
    height: 6px;
  }

  .filters-container::-webkit-scrollbar-thumb {
    background-color: #ccc;
    border-radius: 10px;
  }

  .filter {
    flex: 0 0 auto;
    min-width: max-content;
    display: flex;
    flex-direction: column;
    align-items: center;
    text-align: center;
    padding: 5px;
  }

  .more-button,
  .tax-toggle {
    flex-shrink: 0;
    white-space: nowrap;
  }
}




/* âœ… Mobile screens: vertical scroll layout */

@media (max-width: 480px) {
  /* Stack filter section vertically */
  #filters {
    display: flex;
    flex-direction: column;
    align-items: stretch;
    width: 100%;
    padding: 10px;
    box-sizing: border-box;
  }

  /* Top bar: dots and toggle in one row */
  .top-bar {
    display: flex;
    flex-direction: row;
    justify-content: space-between;
    align-items: center;
    width: 100%;
    gap: 0.5rem;
    margin-bottom: 0.5rem;
  }

  /* Show the three-dot button */
  .more-button {
    display: block;
    font-size: 24px;
    cursor: pointer;
    background: none;
    border: none;
    padding: 0;
    line-height: 1;
    flex-shrink: 0;
  }

  /* Keep toggle aligned on right */
  .tax-toggle {
    flex-shrink: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
  }

  /* Filter section hidden by default */
  .filters-container {
    display: none;
    flex-direction: column;
    gap: 10px;
    max-height: 200px;
    overflow-y: auto;
    width: 100%;
    margin-top: 10px;
    border-top: 1px solid #ddd;
    padding-top: 10px;
  }

  /* Show filters when toggled */
  .filters-container.show {
    display: flex;
  }

  /* Align filter items in a row */
  .filter {
    display: flex;
    flex-direction: row;
    gap: 10px;
    align-items: center;
  }
  

.filters-container:not(.show) {
  max-height: 0;
  padding-top: 0;
  border-top: none;
}

}

.tax-info{
  display: none;
}


</style>
<!-- 
<div id="filters" class="collapse navbar-collapse">
  <div class="filter">
    <div><i class="fa-solid fa-fire"></i></div>
    <p>Trending</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-bed"></i></div>
    <p>Rooms</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-mountain-city"></i></div>
    <p>Iconic City</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-mountain"></i></div>
    <p>Mountain</p>
  </div>
  <div class="filter">
    <div><i class="fa-brands fa-fort-awesome"></i></div>
    <p>Castles</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-person-swimming"></i></div>
    <p>Amazing pools</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-campground"></i></div>
    <p>Camping</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-cow"></i></div>
    <p>Farms</p>
  </div>
  <div class="filter">
    <div><i class="fa-solid fa-snowflake"></i></div>
    <p>Arctic</p>
  </div>

  <div class="tax-toogle">
    <div class="form-check-reverse form-switch">
      <input
        class="form-check-input"
        type="checkbox"
        role="switch"
        id="switchCheckDefault"
      />
      <label class="form-check-label" for="switchCheckDefault"
        >Display total after taxes</label
      >
    </div>
  </div>
</div> -->

<!-- search -->



<!-- ----------------- -->
<!-- <div id="filters"> -->
  <!-- Visible Filter Area -->
  <!-- <div class="filters-container" id="filtersContainer">
    <div class="filter"><i class="fa-solid fa-fire"></i><p>Trending</p></div>
    <div class="filter"><i class="fa-solid fa-bed"></i><p>Rooms</p></div>
    <div class="filter"><i class="fa-solid fa-mountain-city"></i><p>Iconic City</p></div>
    <div class="filter"><i class="fa-solid fa-mountain"></i><p>Mountain</p></div>
    <div class="filter"><i class="fa-brands fa-fort-awesome"></i><p>Castles</p></div>
    <div class="filter"><i class="fa-solid fa-person-swimming"></i><p>Amazing pools</p></div>
    <div class="filter"><i class="fa-solid fa-campground"></i><p>Camping</p></div>
    <div class="filter"><i class="fa-solid fa-cow"></i><p>Farms</p></div>
    <div class="filter"><i class="fa-solid fa-snowflake"></i><p>Arctic</p></div>
   
  </div> -->
 <div id="filters">
  <!-- Visible Filter Area -->
  <div class="filters-container" id="filtersContainer">

    <div class="filter" data-category="Trending">
      <i class="fa-solid fa-fire"></i>
      <p>Trending</p>
    </div>

    <div class="filter" data-category="Rooms">
      <i class="fa-solid fa-bed"></i>
      <p>Rooms</p>
    </div>

    <div class="filter" data-category="Iconic City">
      <i class="fa-solid fa-mountain-city"></i>
      <p>Iconic City</p>
    </div>

    <div class="filter" data-category="Mountain">
      <i class="fa-solid fa-mountain"></i>
      <p>Mountain</p>
    </div>

    <div class="filter" data-category="Castles">
      <i class="fa-brands fa-fort-awesome"></i>
      <p>Castles</p>
    </div>

    
      <div class="filter" data-category="Historical">
       <i class="fa-solid fa-landmark"></i>
        <p>Historical</p>
      </div>

      <div class="filter" data-category="Desert">
        <i class="fa-solid fa-sun-plant-wilt"></i> <!-- or fa-sun -->
        <p>Desert</p>
      </div>

      <div class="filter" data-category="Luxury">
           <i class="fa-solid fa-gem"></i>
           <p>Luxury</p>
      </div>

        <div class="filter" data-category="Beachfront">
            <i class="fa-solid fa-umbrella-beach"></i>
            <p>Beachfront</p>
      </div>

    <div class="filter" data-category="Camping">
      <i class="fa-solid fa-campground"></i>
      <p>Camping</p>
    </div>

    <div class="filter" data-category="Farms">
      <i class="fa-solid fa-cow"></i>
      <p>Farms</p>
    </div>

    <div class="filter" data-category="Arctic">
      <i class="fa-solid fa-snowflake"></i>
      <p>Arctic</p>
    </div>

  </div>
  
  <!-- Three dots button -->
  <div class="more-button" id="moreButton">â‹¯</div>

  <!-- Always visible toggle -->
  <div class="tax-toggle">
    <div class="form-check-reverse form-switch">
      <input
        class="form-check-input"
        type="checkbox"
        role="switch"
        id="switchCheckDefault"
      />
      <label class="form-check-label" for="switchCheckDefault">
        Display total after taxes
      </label>
    </div>
  </div>
</div>
</div>

 <!-- -------------------- -->

<div class="row row-cols-lg-3 row-cols-md-2 row-cols-sm-1 mt-3">
  <% for(let listing of listings){%>
  <a href="/listings/<%= listing._id %>" class="listing-link">
    <div class="card col listing-card">
      <img
        src="<%=listing.image.url%>"
        class="card-img-top"
        alt="listing_image"
        style="height: 20rem"
      />
      <div class="card-img-overlay"></div>
      <div class="card-body">
        <p class="card-text">
          <b><%= listing.title%> </b><br />
          <%=listing.price.toLocaleString("en-IN")%>/night
       <i class="tax-info"> &nbsp; &nbsp;+18% GST</i>
        </p>
      </div>
    </div>
  </a>
  <%}%>
</div>

<!-- </body> -->
<!-- </html> -->
<script>
  let taxSwitch =document.getElementById("switchCheckDefault");
  taxSwitch.addEventListener("click", ()=>{
    let taxInfo = document.getElementsByClassName("tax-info");
    for(info of taxInfo){
      if(info.style.display != "inline"){
        info.style.display = "inline";
      }
      else{

        info.style.display="none";
      }
    }
  })

// filter
const moreButton = document.getElementById("moreButton");
const filtersContainer = document.getElementById("filtersContainer");

moreButton.addEventListener("click", () => {
  filtersContainer.classList.toggle("show");
});


// filter clike 
const filters = document.querySelectorAll('.filter');

filters.forEach(filter => {
  filter.addEventListener('click', () => {
    const selectedCategory = filter.getAttribute('data-category');
    
    // Redirect to filtered listings page (Backend method)
    window.location.href = `/listings/filter?category=${encodeURIComponent(selectedCategory)}`;

    // OR call frontend function
    // filterListings(selectedCategory);
  });
});

function filterListings(category) {
  const allListings = document.querySelectorAll('.listing-card');

  allListings.forEach(card => {
    const cardCategory = card.getAttribute('data-category');
    if (cardCategory === category || category === 'All') {
      card.style.display = 'block';
    } else {
      card.style.display = 'none';
    }
  });
}


</script>